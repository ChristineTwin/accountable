# Weekly Report Form — Design Specifications

**Author:** Ian Duggan  
**Purpose:** Defines the user goals, data requirements, layout, validation rules, and workflow for the Weekly Report Entry Form.

---

## 1. User Goals & Context
The Weekly Report Entry form is used by project staff to log the work they completed during the week for one or more funded projects. Each weekly report captures a snapshot of activities, hours worked, and narrative updates that contribute to project progress, funder reporting, and compliance documentation.

Users typically access this form once per week, per project they are assigned to. The form allows them to enter multiple activity items, each representing a distinct task, deliverable, or work session. Each activity item includes the number of hours worked and a brief narrative summary describing what was accomplished.

The primary goals of the user when interacting with this form are to:

1. Select the appropriate project they are reporting on.

2. Record the hours worked for that week.

3. Provide narrative descriptions of the work completed.

4. Submit project information efficiently and accurately.

5. Ensure compliance with funder and internal reporting standards.

This form should minimize manual effort while ensuring that all required information is captured in a structured, consistent format. It serves as the user-facing entry point to populate the weekly_report and w_report_item tables in the database.

## 2. Data Fields and Database Mappings

This section identifies all fields required for the Weekly Report Entry form and maps each field to the appropriate PostgreSQL table and column. The Weekly Report workflow inserts one record into weekly_report and one or more itemized activity records into w_report_item.

### 2.1 Parent Record — weekly_report Table

This table represents the high-level weekly report for a given person and project.
A new row is created each time a user submits a weekly report.

| Form Field          | Description                  | Database Table  | Column       | Notes                                                                  |
| ------------------- | ---------------------------- | --------------- | ------------ | ---------------------------------------------------------------------- |
| **Project**         | Project being reported on    | `weekly_report` | `project_id` | Selected from dropdown populated via `/api/projects`                   |
| **Reporter / User** | Person submitting the report | `weekly_report` | `person_id`  | Pulled automatically from authenticated session (not selectable in UI) |
| **Timestamp**       | Report submission time       | `weekly_report` | `timestamp`  | Auto-generated by database (`DEFAULT CURRENT_TIMESTAMP`)               |

### 2.2 Activity Items — w_report_item Table

Each weekly report contains one or more activity items.
Each item corresponds to a row in w_report_item.


| Form Field                  | Description                         | Database Table  | Column        | Notes                                        |
| --------------------------- | ----------------------------------- | --------------- | ------------- | -------------------------------------------- |
| **Hours Worked**            | Number of hours for this activity   | `w_report_item` | `hours`       | Decimal; must be `> 0`                       |
| **Activity Description**    | Narrative summary of work completed | `w_report_item` | `text`        | Required text field                          |
| **Parent Weekly Report ID** | Link to weekly report               | `w_report_item` | `w_report_id` | Set automatically after parent record insert |

The user should be allowed to add 1-N items, with a button like "Add another activity."

## 3. Form Layout and UX Structure

The Weekly Report Entry form is composed of two major sections:

1. Report Header (Parent Record)


- Contains project selection

- Displays reporter’s identity (auto-filled)

- Captures no other user-editable fields


2. Activity Item Entries (Child Records)

- Each activity includes hours worked and a narrative description

- Users may add 1–N activity items

- Items can be added or removed dynamically

The layout below is intended as a suggested design specification for the front-end and describes the required structure, grouping, and interactive behavior.

### 3.1 High-Level Page Structure

**Page Layout**

- **Weekly Report — New Entry**
- **Section A — Project Information**
- **Section B — Activity Entries (1–N items)**
- **Submit Button**

The page should be simple, uncluttered, and optimized for fast weekly use.

### 3.2 Section A — Project Information (Parent Record)

| Label        | Type              | Notes                                                         |
| ------------ | ----------------- | ------------------------------------------------------------- |
| **Project**  | Dropdown          | Populated via `/api/projects`; required                       |
| **Reporter** | Display-only text | Pulled from authenticated session (`person_id`); not editable |

#### Behavior Notes

- Project dropdown must be selected before submitting.

- Reporter name should display to reassure user they are logged in and reporting as the correct person.

### 3.3 Section B — Activity Entries (Repeatable 1–N Items)

Each activity item block includes:

### 3.3.1 Fields

| Label                             | Type                            | Notes                 |
| --------------------------------- | ------------------------------- | --------------------- |
| **Hours Worked**                  | Numeric input (decimal allowed) | Required; must be > 0 |
| **Description of Work Completed** | Multi-line textbox              | Required              |

### 3.3.2 Layout Example

Activity Item #1
-----------------------------------------
 Hours Worked:     [   2.5   ]
 Description:
 [ Reviewed raw survey data and cleaned records
   for project dataset. ]

 [ Remove this activity ] (button)
-----------------------------------------

[ + Add another activity ] (button)

### 3.3.3 Behavior Notes

- Users must always have at least one activity entry.

- Each click on Add another activity appends a new activity block.

- Each activity block includes a Remove button, except when only one block remains.

- When the user submits:

  - The system creates 1 parent row (weekly_report)

  - Then creates N child rows (w_report_item)

### 3.4 Buttons and Considerations

#### Add Another Activity

- Appends a new blank activity block.

- Should scroll into view or auto-focus the first input.

#### Remove Activity

- Removes an activity item.

- Disabled or hidden if only one item remains.

#### Submit Weekly Report

- Validates all fields.

- Sends:

1. POST /api/weekly-reports

2. POST /api/weekly-reports/:id/items for each item

#### Cancel / Return to Dashboard (optional)

- Returns the user to project dashboard without submitting.

### 3.5 Example Rough Mockup

--------------------------------------------------------
 Weekly Report — New Entry
--------------------------------------------------------

 Project: [ Select Project ▼ ]
 Reporter: Ian Duggan (auto-filled)

--------------------------------------------------------
 Activity Item 1
--------------------------------------------------------
 Hours Worked: [  2.0  ]
 Description:
 [ Completed preliminary data cleaning and
   drafted summary notes for PI.              ]

 [ Remove activity ]
--------------------------------------------------------

 [ + Add another activity ]

--------------------------------------------------------
 [   Submit Weekly Report   ]
--------------------------------------------------------

### 3.6 UX Considerations & Recommendations

Large textboxes should auto-expand or provide adequate height.

Decimal input for hours should allow values like 0.25, 1.5, 7.75, etc.

Activity descriptions should provide placeholder guidance like:
“Describe what you accomplished for this work period…”

If validation fails, errors should appear inline beside the fields.

## Step 4 — Validation Requirements

in progress....
